import:
  - display/status

display:
  status:
    memory:
      refresh: 10

      script: |
        def sample!
          case ::Config::CONFIG['host_os']
          when /linux/

            reading = `free -m`
            @used, @free = reading[/cache:(.+)/, 1].split
            @swap = reading[/Swap:(.+)/, 1].split[1]

          when /bsd/

            reading = `vmstat -h`.split("\n")[2].split
            @swap = reading[2]
            @used = reading[3]
            @free = reading[4]

          else
            raise NotImplementedError, 'OS not supported'
          end
        end

      label: |
        sample!
        ['R:', @used, 'F:', @free, 'S:', @swap]

      mouse_action:
        left_click: show_memory_stats

control:
  action:
    show_memory_stats: |
      dialog `vmstat`
