import:
  - display/status

display:
  status:
    memory:
      refresh: 10

      script: |
        case ::Config::CONFIG['host_os']
        when /linux/

          def sample!
            reading = `free -m`
            @used, @free = reading[/cache:(.+)/, 1].split
            @swap = reading[/Swap:(.+)/, 1].split[1]
          end

        when /bsd/

          def sample!
            reading = `vmstat -h`.split("\n")[2].split
            @swap = reading[2]
            @used = reading[3]
            @free = reading[4]
          end

        else
          raise NotImplementedError, 'OS not supported'
        end

      label: |
        sample!
        "mem \u25D2 #{@used}M \u25CC #{@free}M \u25D8 #{@swap}M"

      control:
        action:
          show_memory_stats: dialog `vmstat`

        mouse_action:
          left_click: show_memory_stats
