import:
  - display/status

display:
  status:
    power:
      refresh: 15

      '@low': 15
      '@critical': 5

      label: |
        device, status = `acpi -b`.chomp.split(/: */, 2)
        status, level, time = status.split(/, */)

        icon =
          case status.downcase
          when 'full' then "\u25CF"
          when 'charging' then "\u26A1"
          when 'discharging' then "\u25D3"
          else "\u2047"
          end

        color =
          case [level.to_f, @low, @critical].max
          when @critical then :error
          when @low then :notice
          end

        time = "\u25D4 #{time[/[0:]*(\S+)/, 1]}" if time

        type, id = device.split
        source = id.to_i > 0 ? device : type

        [color, source, icon, level, time].compact

      control:
        action:
          show_battery_info: dialog `acpi -b -i`

        mouse_action:
          left_click: show_battery_info
